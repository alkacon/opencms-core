<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=<%= wp.getEncoding() %>">
<title>(<%= wp.getSettings().getUser().getName() %>) - <%= wp.getParamResource() %></title>

<link rel=stylesheet type="text/css" href="<%= wp.getEditorResourceUri() %>format.css">
<script type="text/javascript">
<!--
	
	<!-- Sets the Document Source-Code for later including into the editor -->
	var text="<%= wp.getParamContent() %>";
	
	<!-- Workplacepath needed in included javascript files -->
	var workplacePath="<%= cms.link("/system/workplace/") %>";

	var NS = null;
	var IE = null;

	NS = (document.layers)? true:false;
	IE = (document.all)? true:false;

	var LANG_CUT = "<%= wp.key("editor.context.cut") %>";
	var LANG_COPY = "<%= wp.key("editor.context.copy") %>";
	var LANG_PASTE = "<%= wp.key("editor.context.paste") %>";
	var LANG_INSERTROW = "<%= wp.key("editor.context.insertrow") %>";
	var LANG_DELETEROW = "<%= wp.key("editor.context.deleterow") %>";
	var LANG_INSERTCOL = "<%= wp.key("editor.context.insertcol") %>";
	var LANG_DELETECOL = "<%= wp.key("editor.context.deletecol") %>";
	var LANG_INSERTCELL = "<%= wp.key("editor.context.insertcell") %>";
	var LANG_DELETECELL = "<%= wp.key("editor.context.deletecell") %>";
	var LANG_MERGECELL = "<%= wp.key("editor.context.mergecell") %>";
	var LANG_SPLITCELL = "<%= wp.key("editor.context.splitcell") %>";
</script>

<script type="text/javascript" src="<%= wp.getEditorResourceUri() %>scripts/edit.js"></script>

<!-- Update the Font display on change -->
<script type="text/javascript" for="EDIT_HTML" event="DisplayChanged">
<!--
	function displayChangedHandle()
	{
	if (IE==true) return DisplayChanged();
	}
	displayChangedHandle();
	//-->
</script>

<!-- Show a context menu if the right mousebutton is clicked -->
<script type="text/javascript" for="EDIT_HTML" event="ShowContextMenu">
<!--
	function showContextMenuHandle()
	{
	if (IE==true) return ShowContextMenu();
	}
	showContextMenuHandle();
//-->
</script>

<!-- Invoke a context menu action -->
<script type="text/javascript" for="EDIT_HTML" event="ContextMenuAction(itemIndex)">
<!--
	function contextMenuActionHandle()
	{
	if (IE==true) return ContextMenuAction(itemIndex);
	}
	contextMenuActionHandle();
//-->
</script>

<!-- Ask user whether he really wants to leave Texteditor without saving -->
<script type="text/javascript">
<!--
	function confirmExit()
	{
		if (EDITOR.edit1.IsModified(2)) {
			if (confirm("<%= wp.key("editor.message.exit") %>")) {
				doEdit(1);
			}
		} else {
				doEdit(1);
		}
	}
	
	function opensmallwin(url, name, w, h) {
    	encodedurl = encodeURI(url);
    	smallwindow = window.open(encodedurl, name, 'toolbar=no,location=no,directories=no,status=no,menubar=0,scrollbars=yes,resizable=yes,top=150,left=660,width='+w+',height='+h);
    	if(smallwindow != null) {
       		if (smallwindow.opener == null) {
         		smallwindow.opener = self;
        	}
		}
	    return smallwindow;
	}
//-->
</script>

</head>

<body class="buttons-head" unselectable="on" onload="setText();">
<table cellspacing="0" cellpadding="0" border="0" width="100%" height="100%">
<form name="EDITOR" id="EDITOR" method="post" action="<%= wp.getDialogUri() %>">
<input type="hidden" name="content">
<input type="hidden" name="action" value="<%= wp.getParamAction() %>">
<input type="hidden" name="resource" value="<%= wp.getParamResource() %>">
<input type="hidden" name="noactivex" value="<%= wp.getParamNoactivex() %>">
<input type="hidden" name="editastext" value="<%= wp.getParamEditastext() %>">
<input type="hidden" name="directedit" value="<%= wp.getParamDirectedit() %>">
	<tr>
		<td>

<%= wp.buttonBar(wp.HTML_START) %>
<%= wp.buttonBarStartTab(0, 5) %>
<%= wp.button("javascript:doEdit(2);", null, "bu_save_exit", "button.saveclose", buttonStyle) %>
<%= wp.button("javascript:doEdit(3);", null, "bu_save", "button.save", buttonStyle) %>
<%= wp.buttonBarSeparator(5, 5) %>
<%= wp.button("javascript:doEdit(4);", null, "bu_undo", "button.undo", buttonStyle) %>
<%= wp.button("javascript:doEdit(5);", null, "bu_redo", "button.redo", buttonStyle) %>
<%= wp.buttonBarSeparator(5, 5) %>
<%= wp.button("javascript:doEdit(6);", null, "bu_search", "button.search", buttonStyle) %>
<%= wp.button("javascript:doEdit(7);", null, "bu_replace", "button.replace", buttonStyle) %>
<%= wp.button("javascript:doEdit(8);", null, "bu_goto", "button.goto", buttonStyle) %>
<%= wp.buttonBarSeparator(5, 5) %>
<%= wp.button("javascript:doEdit(9);", null, "bu_cut", "button.cut", buttonStyle) %>
<%= wp.button("javascript:doEdit(10);", null, "bu_copy", "button.copy", buttonStyle) %>
<%= wp.button("javascript:doEdit(11);", null, "bu_paste", "button.paste", buttonStyle) %>
<%			
if (options.showElement("button.print")) {%>
	<%= wp.buttonBarSeparator(5, 5) %>
	<%= wp.button("javascript:doEdit(15);", null, "bu_print", "button.print", buttonStyle) %><%
}
if (wp.isHelpEnabled()) {%>
	<%= wp.buttonBarSeparator(5, 5) %>
	<%= wp.button("javascript:treewin=opensmallwin(workplacePath + 'help/" + wp.getSettings().getLanguage() + "/" + wp.key("help.pageeditor") + "', '" + wp.key("button.help") + "', 600, 450);treewin.focus();", null, "bu_help", "button.help", buttonStyle) %><%
} %>
<td class="maxwidth">&nbsp;</td>
<%= wp.button("javascript:confirmExit();", null, "bu_exit", "button.close", buttonStyle) %>
<%= wp.buttonBarSpacer(5) %>
<%= wp.buttonBar(wp.HTML_END) %>
</td>
<tr>
<tr>

		<td class="texteditor" height="100%" width="100%">
		<OBJECT classid="clsid:EB3A74C0-5343-101D-BB4D-040224009C02" width="100%" height="100%" id="edit1" name="edit1" onFocus="setTextDelayed();">
			<PARAM NAME="_StockProps" VALUE="125">
			<PARAM NAME="Text" VALUE="Loading .....">
			<PARAM NAME="ForeColor" VALUE="0">
			<PARAM NAME="BackColor" VALUE="16777215">
			<PARAM NAME="BorderStyle" VALUE="1">
			<PARAM NAME="Enabled" VALUE="-1">
			<PARAM NAME="AutoIndent" VALUE="-1">
			<PARAM NAME="BackColorSelected" VALUE="8388608">
			<PARAM NAME="BookmarksMax" VALUE="16">
			<PARAM NAME="CanChangeFile" VALUE="0">
			<PARAM NAME="CanChangeFont" VALUE="0">
			<PARAM NAME="CaretWidth" VALUE="0">
			<PARAM NAME="DefaultSelection" VALUE="-1">
			<PARAM NAME="ExtraComments" VALUE="0">
			<PARAM NAME="Item2AsComment" VALUE="0">
			<PARAM NAME="UnixStyleSave" VALUE="0">
			<PARAM NAME="CurrentWordAsText" VALUE="0">
			<PARAM NAME="MultilineItems" VALUE="0">
			<PARAM NAME="MultilineStrings" VALUE="0">
			<PARAM NAME="SinglelineStrings" VALUE="0">
			<PARAM NAME="ExtraHorzSpacing" VALUE="3">
			<PARAM NAME="ExtraVertSpacing" VALUE="0">
			<PARAM NAME="FileMask" VALUE="/All Files/*.*/">
			<PARAM NAME="FileName" VALUE="+">
			<PARAM NAME="ForeColorSelected" VALUE="16777215">
			<PARAM NAME="HasFile" VALUE="-1">
			<PARAM NAME="HasMenu" VALUE="0">
			<PARAM NAME="Highlight" VALUE="0">
			<PARAM NAME="InsertMode" VALUE="1">
			<PARAM NAME="ScrollBars" VALUE="3">
			<PARAM NAME="Syntax" VALUE="">
			<PARAM NAME="PaintMode" VALUE="0">
			<PARAM NAME="TabStopSize" VALUE="4">
			<PARAM NAME="ReadOnly" VALUE="0">
			<PARAM NAME="UndoDepth" VALUE="-1">
			<PARAM NAME="InitializeType" VALUE="0">
			<PARAM NAME="GroupNumber" VALUE="0">
			<PARAM NAME="StartInComments" VALUE="0">
			<PARAM NAME="MacStyleSave" VALUE="0">
			<PARAM NAME="WantTab" VALUE="-1">
			<PARAM NAME="WordWrap" VALUE="0">
			<PARAM NAME="WordWrapAuto" VALUE="-1">
			<PARAM NAME="WordWrapRMargin" VALUE="0">
			<PARAM NAME="WordWrapWidth" VALUE="0">
			<PARAM NAME="NoPrintDialog" VALUE="0">
			<PARAM NAME="NoPrintProgress" VALUE="0">
			<PARAM NAME="WrapKeys" VALUE="0">
			<PARAM NAME="BackColorPrint" VALUE="16777215">
			<PARAM NAME="PrintJobName" VALUE="Document">
			<PARAM NAME="ZeroSubstitute" VALUE="0">
		</OBJECT>
		<script type="text/javascript">
		<!--
			if(document.edit1 != true) document.location=document.location+"&noactivex=true";
		// -->
		</script>
		</td>
	</tr>
</form>
</table>
</body>
</html>